@inherits ViewPage<WebCourse>
@{
    ViewBag.Title = Model.Course.CourseName;
}
<link href="/Scripts/lib/codemirror.css" rel="stylesheet" />
<link href="/Scripts/lib/theme/ambiance.css" rel="stylesheet" />
<link href="/Content/themes/base/jquery-ui.css" rel="stylesheet" />
<link rel="stylesheet" href="Scripts/lib/doc/docs.css">
<script src="/Scripts/lib/codemirror.js" type="text/javascript"></script>
<script src="/Scripts/jquery-1.8.2.js" type="text/javascript"></script>
<script src="/Scripts/lib/mode/clike/clike.js" type="text/javascript"></script>
<script src="/Scripts/jquery-ui-1.9.0.js"></script>
@{
    if (Model.CurrentLevelNo == default(int))
    {
    <h1>@Model.Course.CourseName</h1>
    <a href="/levels/@Model.Course.Id/1">Start the course</a>
    }

    else if (Model.CurrentChallengeNo == default(int))
    {
    <div align="center">
        <iframe src="@Model.CurrentLevel.LevelVideoUri" width="800" 
                    height="600" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
        <br />
        <a  href="/challenges/@Model.Course.Id/@Model.CurrentLevelNo/1">Challenges</a>
    </div>
    }

    else
    {
        <div id="tabs">
    <p>@Model.CurrentChallenge.Instructions</p>
        <ul>
            @{
                foreach (var codeFile in Model.CurrentChallenge.CodeFiles)
                {
                    <li><a href="#tabs-@codeFile.Order">@codeFile.FileName</a></li>
                }
            }
        </ul>
        @{
            foreach (var codeFile in Model.CurrentChallenge.CodeFiles)
            {
                <div id="tabs-@codeFile.Order"><textarea data-editable="@codeFile.Editable">@codeFile.InitialText</textarea></div>
            }
        }
        </div>
    <button value="Submit"></button>
        
    <script type="text/javascript">
        $(function() {
            $('textarea').each(function(index, textArea) {
                CodeMirror.fromTextArea(textArea, {
                    mode: "text/x-csharp",
                    lineNumbers: true,
                    matchBrackets: true,
                    theme: "ambiance",
                    readOnly: $(textArea).data('editable').toLowerCase() == "false"
                });
            });

            $("#tabs").tabs();
        });
    </script>
    }
}